{{define "me"}}
<html lang="en">
<head>
<title>{{.IngressName}} Agent data</title>
{{template "styles"}}
</head>
<body>
{{template "nav"}}
	<div class="content-sction-a">
		<div class="container">
			<div class="row">
				<div class="col-lg-12">
					<div class="content-section-a">
<!-- content starts here -->
<div class="card mb-2">
<div class="card-header">My Assignments</div>
<div class="card-body">
<small>A list of operations with tasks assigned to me will go here.</small>
</div>
  <ul class="list-group list-group-flush">
  </ul>
</div>

<div class="card mb-2">
<div class="card-header">Teams</div>
<div class="card-body">
<small>Disable inactive teams. It is good opsec and reduces data transfer. If you use OneTracks and want to submit waypoints, you must set a primary team.</small>
</div>
  <ul class="list-group list-group-flush">
	{{range .Teams}}
		<li class="list-group-item">{{.Name}} ({{.State}})  
{{if eq .State "Off"}}
			[ <a href="{{WebAPIPath}}/me/{{.ID}}?state=On">On</a> ]
{{else}}
    {{if eq .State "Primary"}}
			[ <a href="{{WebAPIPath}}/me/{{.ID}}?state=Off">Off</a> ]
    {{else}}
			[ <a href="{{WebAPIPath}}/me/{{.ID}}?state=Off">Off</a> |
			<a href="{{WebAPIPath}}/me/{{.ID}}?state=Primary">Primary</a> ]
    {{end}}
{{end}}
{{if .RocksComm}}
			[ <a href="https://enlightened.rocks/comm/{{.RocksComm}}">This team is managed at enlightened.rocks</a> ]
{{else}}
			[ <a href="{{WebAPIPath}}/me/{{.ID}}/delete">Remove Me</a> ]
{{end}}
		</li>
	{{end}}
  </ul>
</div>

<div class="card mb-2">
<div class="card-header">Operations</div>
<div class="card-body">
<small>Disable inactive teams to hide operations.</small>
</div>
  <ul class="list-group list-group-flush">
	{{range .Ops}}
		<li class="list-group-item"><a href="{{WebAPIPath}}/draw/{{.ID}}">{{.Name}}</a> ({{.TeamName}})</li>
	{{end}}
  </ul>
</div>

<div class="card mb-2">
  <div class="card-header">My Teams</div>
  <div class="card-body">
  </div>
  <ul class="list-group list-group-flush">
{{range .OwnedTeams}}
    <li class="list-group-item">
	<a href="{{WebAPIPath}}/team/{{.ID}}/edit" class="card-link">{{.Name}}</a> [ <a href="{{WebAPIPath}}/team/{{.ID}}/delete" class="card-link">Delete</a> ]
	</li>
{{end}}
  <li class="list-group-item">
    <form action="{{WebAPIPath}}/team/new" method="get">
    <input type="text" name="name" />
    <input type="submit" name="update" value="new team" />
    </form>
  </li>
  </ul>
</div>
		<!-- content ends here -->				
						
					</div>
				</div>
			</div>

		</div>
		<!-- /.container -->

	</div>
	<!-- /.intro-header -->

{{template "footer"}}

	<script>
function geoFindMe() {
  const lat = document.querySelector('#lat');
  const lon = document.querySelector('#lon');

  function success(position) {
	lat.value = position.coords.latitude;
	lon.value = position.coords.longitude;
  }

  function error() {
	lat.value = '-0';
	lon.value = '-0';
  }

  if (navigator.geolocation) {
	navigator.geolocation.getCurrentPosition(success, error);
  }

}
document.querySelector('#lat').addEventListener('click', geoFindMe);
document.querySelector('#lon').addEventListener('click', geoFindMe);
	</script>

	<!-- jQuery -->
	<script src="https://wasabee.rocks/js/jquery.js"></script>

	<!-- Bootstrap Core JavaScript -->
	<script src="https://wasabee.rocks/js/bootstrap.min.js"></script>
</body>
</html>
{{end}}
